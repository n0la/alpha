<form class="flexcol {{cssClass}}"
      autocomplete="off">
    {{!-- Sheet Header --}}
    <header class="sheet-header">
        <img class="profile-img"
             src="{{actor.img}}"
             data-edit="img"
             title="{{actor.name}}"
             height="100"
             width="100" />
        <div class="header-fields">
            <h1 class="charname">
                <input name="name"
                       type="text"
                       value="{{actor.name}}"
                       placeholder="Name" />
            </h1>
            <div class="resource">
                Level: <input name="data.level.value"
                       type="number"
                       value="{{data.level.value}}"
                       placeholder="Level" />
            </div>
            <div class="resource">
                XP: <input name="data.xp.value"
                       type="number"
                       value="{{data.xp.value}}"
                       placeholder="XP" />
            </div>
        </div>
    </header>

    {{!-- Sheet Tab Navigation --}}
    <nav class="sheet-tabs tabs"
         data-group="primary">
        <a class="item"
           data-tab="attributes">Attributes</a>
        <a class="item"
           data-tab="skills">Skills</a>
        <a class="item"
           data-tab="items">Items</a>
    </nav>

    {{!-- Sheet Body --}}
    <section class="sheet-body">
        {{!-- Attributes Tab --}}
        {{> "systems/alpha/templates/sheet/attributes.html" }}

        {{!-- Skills Tab --}}
        {{> "systems/alpha/templates/sheet/skills.html" }}

        {{!-- Owned Items Tab --}}
        <div class="tab items"
             data-group="primary"
             data-tab="items">
            <ol class="item-list">
                {{#each actor.items as |item id|}}
                <li class="item flexrow"
                    data-item-id="{{item._id}}">
                    <img src="{{item.img}}"
                         title="{{item.name}}"
                         width="24"
                         height="24" />
                    <h4 class="item-name">{{item.name}}</h4>
                    {{!-- Iterate through all attributes on the item and output buttons for any that are formula. --}}
                    <div class="item-buttons">
                        {{#each item.data.attributes as |itemAttr key|}}
                        {{#if itemAttr.dtype}}
                        {{#if itemAttr.isFormula}}
                        {{!-- Use the items.name.key format for shorthand. --}}
                        {{#if ../../shorthand}}
                        <button class="item-button rollable"
                                data-roll="@items.{{slugify item.name}}.{{key}}"
                                data-label="{{ itemAttr.label }}"
                                title="{{itemAttr.value}}">{{itemAttr.label}}</button>
                        {{!-- Use the items.name.attributes.key.value format otherwise. --}}
                        {{else}}
                        <button class="item-button rollable"
                                data-roll="@items.{{slugify item.name}}.attributes.{{key}}.value"
                                data-label="{{ itemAttr.label }}"
                                title="{{itemAttr.value}}">{{itemAttr.label}}</button>
                        {{/if}}
                        {{/if}}
                        {{else}}
                        {{#each itemAttr as |itemGroupedAttr groupedKey|}}
                        {{#if itemGroupedAttr.isFormula}}
                        {{!-- Use the items.name.key format for shorthand. --}}
                        {{#if ../../../shorthand}}
                        <button class="item-button rollable"
                                data-roll="@items.{{slugify item.name}}.{{key}}.{{groupedKey}}"
                                data-label="{{ itemGroupedAttr.label }}"
                                title="{{itemGroupedAttr.value}}">{{itemGroupedAttr.label}}</button>
                        {{!-- Use the items.name.attributes.key.value format otherwise. --}}
                        {{else}}
                        <button class="item-button rollable"
                                data-roll="@items.{{slugify item.name}}.attributes.{{key}}.{{groupedKey}}.value"
                                data-label="{{ itemGroupedAttr.label }}"
                                title="{{itemGroupedAttr.value}}">{{itemGroupedAttr.label}}</button>
                        {{/if}}
                        {{/if}}
                        {{/each}}
                        {{/if}}
                        {{/each}}
                    </div>
                    <div class="item-controls">
                        <a class="item-control item-edit"
                           title="Edit Item"><i class="fas fa-edit"></i></a>
                        <a class="item-control item-delete"
                           title="Delete Item"><i class="fas fa-trash"></i></a>
                    </div>
                </li>
                {{/each}}
            </ol>
        </div>
    </section>
</form>